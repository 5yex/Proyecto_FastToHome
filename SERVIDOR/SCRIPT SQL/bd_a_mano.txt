DROP DATABASE bdamano;
CREATE DATABASE bdamano;

CREATE TABLE IF NOT EXISTS direccion(
    id int(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,
    calle varchar(50) NOT NULL,
    numero int(3) NOT NULL,
    ciudad varchar(30) NOT NULL,
    provincia varchar(30) NOT NULL,
    cp int(5) NOT NULL,
    otros varchar(30) NOT NULL,
    coordenadas varchar(40) NOT NULL
);

INSERT INTO direccion (calle, numero, ciudad, provincia, cp, otros, coordenadas) 
	VALUES ('Martires', 34, 'Espa', 'Bada', 06439, 'Con terraza y patio', '18,-63');

CREATE TABLE IF NOT EXISTS categoria_negocio(
    id int(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,
    nombre varchar(30) NOT NULL
);


CREATE TABLE IF NOT EXISTS usuarios(
    id int(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,
    nombre varchar(20) NOT NULL,
    dni varchar(9) NOT NULL UNIQUE,
    email varchar(30) NOT NULL,
    tlf int(11) NOT NULL,
    rol ENUM('cliente','mercader','admin') NOT NULL,
    password varchar(40) NOT NULL
);

ALTER TABLE usuarios ADD COLUMN id_direccion int(11) NOT NULL;
ALTER TABLE usuarios ADD FOREIGN KEY (id_direccion) 
	REFERENCES direccion(id) ON DELETE CASCADE;
